<?xml version="1.0" encoding="UTF-8"?>
<txnmgr name="transactionManager" class="org.jpos.transaction.TransactionManager" logger="Q2">
    <property name="space" value="tspace:default" />
    <property name="queue" value="txnmgr" />
    <property name="sessions" value="10" />
    <property name="max-sessions" value="128" />
    <property name="debug" value="true" />

    <!-- Sign-on validation - terminals must sign on before transacting (allows 0800 messages) -->
    <participant class="com.example.atm.jpos.participant.SignOnValidationParticipant" logger="Q2" realm="signon-validation" />
    <!-- MAC verification to verify message integrity -->
    <participant class="com.example.atm.jpos.participant.MacVerificationParticipant" logger="Q2" realm="mac-verification" />
    <!-- Key change handling for network management messages (MTI 0800) -->
    <participant class="com.example.atm.jpos.participant.KeyChangeParticipant" logger="Q2" realm="key-change" />
    <!-- Financial transaction participants (only process MTI 0200) -->
    <!-- Account validation before PIN verification - no need to verify PIN for non-existent accounts -->
    <participant class="com.example.atm.jpos.participant.AccountValidationParticipant" logger="Q2" realm="account-validation" />
    <participant class="com.example.atm.jpos.participant.PinVerificationParticipant" logger="Q2" realm="pin-verification" />
    <participant class="com.example.atm.jpos.participant.BalanceInquiryParticipant" logger="Q2" realm="balance-inquiry" />
    <participant class="com.example.atm.jpos.participant.WithdrawalParticipant" logger="Q2" realm="withdrawal" />
    <!-- Response participants - always run even when earlier participants abort -->
    <participant class="com.example.atm.jpos.participant.ResponseBuilderParticipant" logger="Q2" realm="response-builder" />
    <!-- MAC generation happens in commit phase of SendResponseParticipant -->
    <participant class="com.example.atm.jpos.participant.SendResponseParticipant" logger="Q2" realm="send-response" />
    <!-- Key activation after response sent - activates PENDING keys when terminal uses them -->
    <participant class="com.example.atm.jpos.participant.KeyActivationParticipant" logger="Q2" realm="key-activation" />
</txnmgr>
