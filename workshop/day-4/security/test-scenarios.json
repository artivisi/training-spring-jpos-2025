{
  "atmSecurityTestScenarios": {
    "description": "Master index for ATM security test scenarios - Day 4 Workshop",
    "version": "1.0",
    "lastUpdated": "2025-11-02",
    "overview": {
      "purpose": "Comprehensive test suite for ATM security features including PIN verification, MAC generation, key rotation, and end-to-end transactions",
      "scope": "Covers HSM integration, cryptographic operations, ISO-8583 messaging, and security error handling",
      "testEnvironment": {
        "hsmSimulator": "http://localhost:8080",
        "bankServer": "http://localhost:9090",
        "atmSimulator": "http://localhost:7070",
        "database": "PostgreSQL on localhost:5432"
      }
    },
    "testCategories": [
      {
        "category": "Configuration",
        "file": "test-config.json",
        "description": "Shared configuration, test data, and cryptographic keys for all test scenarios",
        "includes": [
          "Service URLs and ports",
          "Test terminal configuration (TRM-ISS001-ATM-001)",
          "Test accounts (3 accounts with different PIN verification methods)",
          "Cryptographic keys (TPK, TSK)",
          "ISO-8583 constants (processing codes, response codes)"
        ]
      },
      {
        "category": "PIN Operations",
        "file": "pin-operations-test.json",
        "description": "PIN encryption, decryption, and verification test scenarios",
        "testCount": 4,
        "includes": [
          "PIN verification with PVV (recommended method)",
          "PIN verification failure (incorrect PIN)",
          "PIN encryption for terminal",
          "PIN block generation (ISO-0 format)"
        ],
        "hsmEndpoints": [
          "POST /api/hsm/pin/verify-with-pvv",
          "POST /api/hsm/pin/encrypt",
          "POST /api/hsm/pin/generate-pinblock"
        ]
      },
      {
        "category": "MAC Operations",
        "file": "mac-operations-test.json",
        "description": "MAC generation and verification for message integrity",
        "testCount": 5,
        "includes": [
          "MAC generation with AES-CMAC",
          "MAC verification (valid)",
          "MAC verification failure (tampered message)",
          "MAC for balance inquiry message",
          "MAC for withdrawal message"
        ],
        "hsmEndpoints": [
          "POST /api/hsm/mac/generate",
          "POST /api/hsm/mac/verify"
        ]
      },
      {
        "category": "Key Rotation",
        "file": "key-rotation-test.json",
        "description": "Terminal-initiated key rotation for TPK and TSK",
        "testCount": 6,
        "includes": [
          "Terminal-initiated TPK rotation",
          "Terminal-initiated TSK rotation",
          "Get updated key",
          "Confirm key installation",
          "Get rotation status",
          "Emergency key rotation"
        ],
        "hsmEndpoints": [
          "POST /api/hsm/terminal/{terminalId}/request-rotation",
          "POST /api/hsm/terminal/{terminalId}/get-updated-key",
          "POST /api/hsm/terminal/{terminalId}/confirm-key-update",
          "GET /api/hsm/rotation/{rotationId}/status"
        ]
      },
      {
        "category": "ATM Transactions",
        "file": "atm-transactions-test.json",
        "description": "End-to-end ATM transaction flows with PIN and MAC security",
        "testCount": 6,
        "includes": [
          "Balance inquiry (successful)",
          "Cash withdrawal (successful)",
          "Withdrawal with insufficient funds",
          "Balance inquiry with invalid PIN",
          "Transaction with invalid account",
          "Transaction without terminal sign-on"
        ],
        "iso8583ProcessingCodes": {
          "balanceInquiry": "310000",
          "withdrawal": "010000"
        },
        "responseCodes": ["00", "14", "51", "55", "91"]
      },
      {
        "category": "Error Scenarios",
        "file": "error-scenarios-test.json",
        "description": "Error handling and security violation detection",
        "testCount": 10,
        "includes": [
          "MAC verification failure (tampered message)",
          "Expired key usage attempt",
          "Invalid PIN format",
          "Missing required field",
          "Key not found",
          "Database connection failure",
          "HSM unavailable",
          "Concurrent transaction conflict",
          "Invalid ISO-8583 message format",
          "Replay attack detection"
        ],
        "severityLevels": {
          "CRITICAL": 4,
          "HIGH": 3,
          "MEDIUM": 3
        }
      },
      {
        "category": "Performance Tests",
        "file": "performance-test.json",
        "description": "Performance benchmarks and load testing scenarios",
        "testCount": 7,
        "includes": [
          "PIN verification performance (100 req/s)",
          "MAC operation performance (200 req/s)",
          "ATM transaction throughput (100 txn/s)",
          "Key rotation performance",
          "Database query performance",
          "Stress test - peak load (500 txn/s)",
          "Soak test - sustained load (2 hours)"
        ],
        "tools": ["Apache JMeter", "k6", "Gatling", "wrk"]
      }
    ],
    "quickStart": {
      "step1": "Review test-config.json for test environment configuration",
      "step2": "Start all services (HSM on 8080, Bank Server on 9090, ATM Simulator on 7070)",
      "step3": "Run PIN operations tests to verify HSM connectivity",
      "step4": "Run MAC operations tests to verify message integrity",
      "step5": "Run key rotation tests to verify key management",
      "step6": "Run ATM transaction tests for end-to-end validation",
      "step7": "Run error scenarios to verify error handling",
      "step8": "Run performance tests to validate under load"
    },
    "testExecution": {
      "manual": {
        "method": "Use curl commands provided in each test file",
        "example": "See curlCommand field in test scenarios"
      },
      "automated": {
        "postman": "Import JSON files into Postman collections",
        "jmeter": "Convert to JMeter test plans",
        "k6": "Convert to k6 JavaScript scripts",
        "junit": "Integrate with Spring Boot test suite"
      }
    },
    "documentation": {
      "workshopInstructions": "../INSTRUCTIONS.md",
      "hsmSimulatorApi": "https://github.com/artivisi/hsm-simulator/blob/main/docs/API.md",
      "iso8583Reference": "ISO 8583:1993 / ISO 8583:2003",
      "pinStandard": "ISO 9564-1",
      "macStandard": "ISO 16609 (AES-CMAC)"
    }
  }
}
